// index.js;
// ÐœÐ¾Ð¶Ð½Ð¾ Ð»ÑƒÑ‡ÑˆÐµ
// Ð•ÑÐ»Ð¸ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ð¾, Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ, ÐºÐ°Ðº Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸Ð·Ð±Ð°Ð²Ð¸Ñ‚ÑŒÑÑ Ð¾Ñ‚ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ñ‚ÐµÐºÑÑ‚Ð° ÐºÐ½Ð¾Ð¿ÐºÐ¸ ÑÐ°Ð±Ð¼Ð¸Ñ‚Ð°,
// Ð¾Ñ‚Ð»Ð¾Ð²Ð° Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð² ÐºÐ°Ð¶Ð´Ð¾Ð¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ:

/*

Ð¼Ð¾Ð¶Ð½Ð¾ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚:
- Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°,
- ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ Ð¿Ð¾Ð¿Ð°Ð¿Ð°
- Ð¸ Ñ‚ÐµÐºÑÑ‚ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

*/

function handleSubmit(request, popupInstance, loadingText = "Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ...") {
  //
  // Ð¸Ð·Ð¼ÐµÐ½ÑÐµÐ¼ Ñ‚ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´Ð¾ Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°
  popupInstance.renderLoading(true, loadingText);

  request()
    .then(() => {
      // Ð·Ð°ÐºÑ€Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾Ð¿Ð°Ð¿ Ð½ÑƒÐ¶Ð½Ð¾ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² `then`
      popupInstance.close();
    })
    .catch((err) => {
      // Ð² ÐºÐ°Ð¶Ð´Ð¾Ð¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ Ð½ÑƒÐ¶Ð½Ð¾ Ð»Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¾ÑˆÐ¸Ð±ÐºÑƒ
      console.error(`ÐžÑˆÐ¸Ð±ÐºÐ°: ${err}`);
    })
    // Ð² ÐºÐ°Ð¶Ð´Ð¾Ð¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ Ð² `finally` Ð½ÑƒÐ¶Ð½Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸
    .finally(() => {
      popupInstance.renderLoading(false);
    });
}

// Ð¿Ñ€Ð¸Ð¼ÐµÑ€ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ° ÑÐ°Ð±Ð¼Ð¸Ñ‚Ð° Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ
function handleProfileFormSubmit(inputValues) {
  // ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¿Ñ€Ð¾Ð¼Ð¸Ñ, Ñ‚Ð°Ðº ÐºÐ°Ðº Ð»ÑŽÐ±Ð¾Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ ÐµÐ³Ð¾
  function makeRequest() {
    // `return` Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¿Ð¾Ñ‚Ð¾Ð¼ Ð´Ð°Ð»ÑŒÑˆÐµ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°Ñ‚ÑŒ Ñ†ÐµÐ¿Ð¾Ñ‡ÐºÑƒ `then, catch, finally`
    return api.editProfile(inputValues).then((userData) => {
      userInfo.setUserInfo(userData);
    });
  }
  // Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ, Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ñ Ð² Ð½ÐµÐµ Ð·Ð°Ð¿Ñ€Ð¾Ñ, ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð¸ Ñ‚ÐµÐºÑÑ‚ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ (ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶ÐµÐ½ Ð´Ñ€ÑƒÐ³Ð¾Ð¹, Ð° Ð½Ðµ `"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ..."`)
  handleSubmit(makeRequest, profilePopup);
}

// Ð½Ð°Ð¿Ð¸ÑÐ°Ð½Ð° Ð½Ð° ÑÑ‚Ñ€Ð¾ÐºÐµ 139 Ð³Ð´Ðµ catch
// ðŸ§¢ Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°ÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ-ÐºÐ¾Ð»Ð±ÑÐº ÑÐ°Ð±Ð¼Ð¸Ñ‚Ð° Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð·Ð°Ñ€Ð°Ð½ÐµÐµ
// const handleSubmitProfile = ({ name, about }) => {
//   // Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ - Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð´ÑƒÑ‚ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€.
//   return api
//     .editProfile(name, about)
//     .then((data) => {
//       myUserInfo.setUserInfo(data);
//       popupProfile.close();
//     })
//     .catch((err) => {
